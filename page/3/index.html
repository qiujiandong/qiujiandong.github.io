<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>小裘控制系统</title><meta name="author" content="裘剑东"><meta name="copyright" content="裘剑东"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="小裘控制系统">
<meta property="og:url" content="http://qjdxmy.com/page/3/">
<meta property="og:site_name" content="小裘控制系统">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qjdxmy.com/img/me.jpg">
<meta property="article:author" content="裘剑东">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qjdxmy.com/img/me.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://qjdxmy.com/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '小裘控制系统',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-01-01 22:35:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/me.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">101</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/download/"><i class="fa-fw fas fa-download"></i><span> 下载</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/resume/"><i class="fa-fw fas fa-heart"></i><span> 个人简历</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/cover.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小裘控制系统</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/download/"><i class="fa-fw fas fa-download"></i><span> 下载</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/resume/"><i class="fa-fw fas fa-heart"></i><span> 个人简历</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">小裘控制系统</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/qiujiandong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1335521934@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/10/02/dsp-opt/" title="C6000 DSP优化技术入门"><img class="post_bg" src="/2022/10/02/dsp-opt/2022-10-02-22-20-37.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C6000 DSP优化技术入门"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/10/02/dsp-opt/" title="C6000 DSP优化技术入门">C6000 DSP优化技术入门</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-10-02T13:24:01.000Z" title="发表于 2022-10-02 21:24:01">2022-10-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/DSP%E5%BC%80%E5%8F%91/">DSP开发</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E4%BC%98%E5%8C%96/">优化</a></span></div><div class="content">参考资料

SPRU198K-TMS320C6000 Programmer’s Guide
SPRUGH7-TMS320C66x DSP CPU and Instruction Set Reference Guide

  主要是看了SPRU198K这个文档里的第三章，这一章里有5个Lesson，非常详细地介绍了一些很实用地优化方法。
  在看这个之前最好对DSP数据路径和功能单元有了解，可以看SPRUGH7这个文档。只有充分发挥出8个功能单元的性能才能说是开发DSP，不然就只是单纯的C/C++开发。哦！还有我觉得起始看第三章之前可以先看一下第四章，第四章介绍了编译器反馈给用户的汇编文件中的一些短语的含义。
一些准备
  DSP优化的过程并不是自己去写汇编而是尽可能多地告诉编译器一些信息，让编译器帮我们优化。
  在工程选项中勾选上-mw和-k，那样可以在编译后生成汇编文件并且有软件流水线相关的信息，便于后续分析。


Lesson1 - 循环内部依赖
  以两个向量的线性乘加运算为例：
sum=∑iω1xi+ω2yisum = \sum\limits_i { {\omega _1}{ ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/10/02/fft-hw/" title="硬件FFT加速模块的应用"><img class="post_bg" src="/2022/10/02/fft-hw/2022-10-02-17-54-54.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="硬件FFT加速模块的应用"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/10/02/fft-hw/" title="硬件FFT加速模块的应用">硬件FFT加速模块的应用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-10-02T07:09:56.000Z" title="发表于 2022-10-02 15:09:56">2022-10-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/DSP%E5%BC%80%E5%8F%91/">DSP开发</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/FFT/">FFT</a></span></div><div class="content">软硬件FFT性能测试
  FFT在很多算法中都有应用，M6678 DSP支持软件FFT（调用DSP库），和硬件FFT（有一个独立的FFT硬件加速模块）。
测试条件

操作系统 Win11
CCS 6.2.0
CGT-Tools 7.4.4
XDCTools 3.25.5.94
SYS/BIOS 6.33.6.50
DSPLIB C66x 3.4.0.4
MATHLIB C66x 3.1.2.4
256kB L2 Cache, 32kB L1P/D Cache
堆区放在DDR，待处理数据与结果数据都在堆区开辟；
待处理的数据均为单精度浮点数，实部虚部交叉存储；
处理器主时钟 1GHz

测试结果
1、 单次运算
  软件FFT以调用FFT函数开始计时，Cache写回之后结束计时。硬件FFT以启动FFT计算开始，收到FFT完成中断后结束计时。



FFT点数
软件FFT
硬件FFT




32
1327 ns
5292 ns


64
1840 ns
5828 ns


128
3078 ns
6372 ns


256
3956 ns
6918 ns



  可以看到单次FFT运算 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/10/01/phase-review-2/" title="近期C6000 DSP开发小结"><img class="post_bg" src="/2022/10/01/phase-review-2/2022-10-01-12-21-52.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="近期C6000 DSP开发小结"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/10/01/phase-review-2/" title="近期C6000 DSP开发小结">近期C6000 DSP开发小结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-10-01T03:25:01.000Z" title="发表于 2022-10-01 11:25:01">2022-10-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/DSP%E5%BC%80%E5%8F%91/">DSP开发</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/DMA/">DMA</a></span></div><div class="content">复数乘法指令
  TI的编译器提供的一些内联函数中可以直接调用复数乘法的汇编指令（CMPYSP，只有C66x DSP支持），完成复数乘法运算。

  src1和src2是连续的两个32位寄存器组成的register pair，dst是由四个连续的32位寄存器组成的register quadruplets。这里只是做了乘法运算。

  然后用DADDSP指令可以对上面的结果中的实数部分和虚数部分分别求和，即可实现复数乘法。
(a+bi)(c+di)=ac−bd+(ad+bc)i\left( {a + b{\rm{i} } } \right)\left( {c + d{\rm{i} } } \right) = ac - bd + \left( {ad + bc} \right){\rm{i} }
(a+bi)(c+di)=ac−bd+(ad+bc)i
  另外编译器也提供了一种快速实现复共轭乘法的方式，即p×q∗p\times q^*p×q∗。乘数中需要求复共轭的数qqq放在src1寄存器对中作为a+bia+b\rm{i}a+bi，另一个乘数ppp放在src2寄存器对中，依次完成CMPYS ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/08/01/vivado-remote/" title="Vivado远程连接调试"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vivado远程连接调试"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/08/01/vivado-remote/" title="Vivado远程连接调试">Vivado远程连接调试</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-01T00:23:25.000Z" title="发表于 2022-08-01 08:23:25">2022-08-01</time></span></div><div class="content">  Vivado对计算机的性能还是有比较高的要求，平时出门带的轻薄本一般跑不了Vivado。即使能运行，肯定也不如台式机来得高效。所以要是能够通过远程连接的方式，通过远程的台式机上的Vivado来调试本地的设备就好了。
内网穿透
  一般我们很少能直接有公网IP，不管是台式机还是笔记本都是连接到某一个局域网里，比如校园网。
远程连接
</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/07/02/fft/" title="傅里叶分析概述"><img class="post_bg" src="/2022/07/02/fft/2022-07-01-08-52-42.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="傅里叶分析概述"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/02/fft/" title="傅里叶分析概述">傅里叶分析概述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-02T00:32:51.000Z" title="发表于 2022-07-02 08:32:51">2022-07-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E5%AD%A6%E7%90%86%E8%AE%BA/">数学理论</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%82%85%E9%87%8C%E5%8F%B6/">傅里叶</a></span></div><div class="content">  傅里叶变换主要分为连续和离散两大块。对连续时间信号的分析，从周期信号的傅里叶级数展开到统一的傅里叶变换（FS），是一套完整地体系。离散时间信号的傅里叶分析和连续时间信号的分析非常像，但确实是不同，没法统一地表示，主要区别在“求和”和“积分”上。FS，FT，DFS，DTFT，DFT构成了整个傅里叶分析的体系。
  不管是哪种变换，都满足“周期-离散”，“非周期-连续”的对应关系。这个关系对帮助记忆非常有用。



分析方法
缩写
变换过程  时域信号 → 频域信号




傅里叶级数
FS
连续周期 → 非周期离散


傅里叶变换
FT
连续周期 → 非周期离散  连续非周期 → 非周期连续


离散傅里叶级数
DFS
离散周期 → 周期离散


离散时间傅里叶变换
DTFT
离散非周期 → 周期连续


离散傅里叶变换
DFT
离散非周期 → 离散非周期  (本质)离散周期 → 周期离散



连续时间傅里叶分析
傅里叶级数
  连续时间的分析得从傅里叶级数开始讲起。
f(t)=f(t+T0)          f(t)=∑n=−∞+∞ane−jnω0f(t) = f(t + {T ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/06/28/stm32-adc/" title="基于STM32的ADC采样序列频谱分析"><img class="post_bg" src="/2022/06/28/stm32-adc/2022-07-01-20-46-34.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于STM32的ADC采样序列频谱分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/28/stm32-adc/" title="基于STM32的ADC采样序列频谱分析">基于STM32的ADC采样序列频谱分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-06-28T08:21:32.000Z" title="发表于 2022-06-28 16:21:32">2022-06-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/">嵌入式软件</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ADC/">ADC</a></span></div><div class="content">  本文主要介绍对ADC采集得到的数字序列进行FFT频谱分析。
理论分析
  确定采样率除了要遵守奈奎斯特采样定律意外还需要考虑一些问题。在数字系统中，我们只能进行一些有限的离散的运算，对于有限长的序列，我们不可能拿它去做DTFT，只能做DFT。这就需要把有限长序列也当作一个周期序列来看待。
归一化角频率
  已知采样率为fsf_sfs​，那么一个频率为f0f_0f0​（f0&lt;fs/2f_0&lt;f_s/2f0​&lt;fs​/2）的理想余弦信号被采样后得到的序列应该是：
x[n]=Acos⁡(2πf0⋅nT0)=Acos⁡(2πf0⋅nfs)    n∈Zx[n] = A\cos \left( {2\pi {f_0} \cdot n{T_0} } \right) = A\cos \left( {2\pi {f_0} \cdot {n \over { {f_s} } } } \right)\;\;n \in {\rm{Z} }
x[n]=Acos(2πf0​⋅nT0​)=Acos(2πf0​⋅fs​n​)n∈Z
  从上面的式子可以看出，我们实际得到的序列和具体的采样率或信号频 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/06/14/bios-srio/" title="SYS/BIOS与SRIO应用实例"><img class="post_bg" src="/2022/06/14/bios-srio/2022-06-14-11-16-30.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SYS/BIOS与SRIO应用实例"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/14/bios-srio/" title="SYS/BIOS与SRIO应用实例">SYS/BIOS与SRIO应用实例</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-06-14T01:53:19.000Z" title="发表于 2022-06-14 09:53:19">2022-06-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%AB%98%E9%80%9F%E9%93%BE%E8%B7%AF/">高速链路</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%AB%98%E9%80%9F%E9%93%BE%E8%B7%AF/SRIO/">SRIO</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/6455/">6455</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/FPGA/">FPGA</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/SRIO/">SRIO</a></span></div><div class="content">

RTSC与XDCTools


基于SRIO的FPGA与DSP间高速数据传输


AXI Memory-Mapped SRIO收发控制器


  SYS/BIOS是TI的实时内核，也叫做TI-RTOS，它是RTSC中的一个软件包，可以使DSP的软件设计更加方便。SRIO是适用于嵌入式系统中的高速接口，之前我也写过一些相关的文章，这次做了一些完善。
系统功能

  整个系统实现的功能大概如上图所示。DSP外接的DDR中存放有两张640×512的图片，DSP与FPGA通过一条1x的SRIO链路相连。DSP周期性地向FPGA发送门铃事务包，由FPGA内的MicroBlaze软核解析后，FPGA端发送相应的多个SRIO NREAD事务包，从DSP外接的DDR中读取特定地址区域的图片，然后通过VGA交替显示两张图片。
  DSP采用的是TMS320C6455，FPGA端实例化MicroBlaze软核处理器，由它向SRIO收发控制器发送命令。
SYS/BIOS的使用
  自从开始使用它以来，我觉得大部分情况下，我们都可以在这个实时内核的框架下来完成应用的设计。它的主要优势在于灵活，相较于传统的 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/05/26/c6678-openmp/" title="OpenMP在多核DSP上的应用"><img class="post_bg" src="/2022/05/26/c6678-openmp/2022-05-26-10-31-10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenMP在多核DSP上的应用"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/05/26/c6678-openmp/" title="OpenMP在多核DSP上的应用">OpenMP在多核DSP上的应用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-05-26T01:58:26.000Z" title="发表于 2022-05-26 09:58:26">2022-05-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/">嵌入式软件</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/OpenMP/">OpenMP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/6678/">6678</a></span></div><div class="content">  TI的多核DSP支持OpenMP，可以方便地使用多核来加速一些计算过程。
编译器
  我使用的DSP是TI的6678，编译器可以是7.4或者8.x版本。7.4版本的编译器只支持OpenMP3.0版本，而8.x版本的编译器支持OpenMP3.0和部分的OpenMP4.0的功能。因为我使用的是7.4版本的编译器，所以后面只对OpenMP3.0相关的设置进行介绍。
参考资料

OpenMP 3.0 Specification
OpenMP 3.0 Summary Card C/C++

  Specification里面介绍了OpenMP实现的机制，重点理解第一章里的“Excution Model”和“Memory Model”。Summary Card是一个总结，相当于一个API手册，可以用它方便地查找命令的语法。
  实际OpenMP的使用除了查阅这两个文档意外还有一些需要注意的地方。
OpenMP模块

BIOSMCSDK-C66X

  TI对OpenMP的支持，我在官网上只找到了这个SDK里有一个omp的模块，这个2.01.02.06应该是在网上能找到的最新的也是唯一的版本了。 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/04/30/cpp-stm32/" title="C++开发STM32 FreeRTOS工程与添加DSP库"><img class="post_bg" src="/2022/04/30/cpp-stm32/2022-04-30-09-44-59.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++开发STM32 FreeRTOS工程与添加DSP库"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/30/cpp-stm32/" title="C++开发STM32 FreeRTOS工程与添加DSP库">C++开发STM32 FreeRTOS工程与添加DSP库</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-30T01:14:38.000Z" title="发表于 2022-04-30 09:14:38">2022-04-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/">嵌入式软件</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DSP/">DSP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/C/">C++</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/FreeRTOS/">FreeRTOS</a></span></div><div class="content">  续上一篇文章的内容。由CubeMX构建的Makefile工程只支持C和汇编的编译，而且FreeRTOS的代码也需要作为C代码编译。
  当我们想使用C++时，需要做一些准备并且修改Makefile；另外本文补充了一下DSP库的调用方式。参考了另外两位博主的文章：

STM32 DSP库的快速添加 基于cubemx 调用，使用DSP库
C++开发STM32 Makefile工程

FreeRTOS与C++
  FreeRTOS的代码是必须作为C语言编译的。C++可以调用C函数，而且也可以在C++的源文件里写C函数。但是C的源文件里不能调用C++相关的东西，比如在C源文件里创建一个类的对象是不行的。
  所以我觉得最好的做法是把任务的定义放到自己的C++源文件中，而在FreeRTOS的C文件中用“extern”声明任务函数。

  具体做法就是在用CubeMX创建Task的时候，把任务的函数都设置成external。这里的默认选项是既有声明又有实现；exteral选项就是只有一个带extern的任务函数声明；还有一个weak选项表示这个任务函数有一个默认的实现，但可以被外部的定义覆盖， ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/04/24/eclipse-base/" title="CubeMX+Eclipse+Jlink STM32开发环境搭建"><img class="post_bg" src="/2022/04/24/eclipse-base/2022-04-24-18-11-15.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CubeMX+Eclipse+Jlink STM32开发环境搭建"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/24/eclipse-base/" title="CubeMX+Eclipse+Jlink STM32开发环境搭建">CubeMX+Eclipse+Jlink STM32开发环境搭建</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-24T09:15:58.000Z" title="发表于 2022-04-24 17:15:58">2022-04-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/">嵌入式软件</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CubeMX/">CubeMX</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Eclipse/">Eclipse</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/STM32/">STM32</a></span></div><div class="content">  Eclipse还是我用得最多的IDE，不管是CCS还是Xilinx的SDK，都是Eclipse的开发环境。所以最近准备做STM32相关的开发时，也准备用Eclipse。
软件下载与安装

STM32CubeMX
Eclipse

  CubeMX是ST的用于生成初始化代码的工具，能大大提升开发的效率。Eclipse是一个开源的IDE，从官网可以下载到这个eclipse installer，然后选择Eclipse IDE for Embedded C/C++ Developers。目前官网的Eclipse版本是2022-03，这也是我目前用的版本。

  Eclipse Embedded CDT，Eclipse的C/C++嵌入式开发工具是一个非常大的开源项目。

  从项目的官网中可以看到，它还提供了一些额外的工具链接，包括build tools和gcc工具链。build tools用来生成Makefile，gcc工具链负责真正的编译和链接。这些工具包都是通过xPack管理的。
  要说xPack得从JavaScript说起，有一个包管理工具叫做npm（Node Package Ma ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/me.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">裘剑东</div><div class="author-info__description">芯来科技基础软件开发工程师，嵌入式开发爱好者</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">101</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qiujiandong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/qiujiandong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1335521934@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">最好的程序员做自己的硬件！</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/01/summary-2024/" title="2024年终总结"><img src="/2025/01/01/summary-2024/2025-01-01-21-54-27.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024年终总结"/></a><div class="content"><a class="title" href="/2025/01/01/summary-2024/" title="2024年终总结">2024年终总结</a><time datetime="2025-01-01T09:19:27.000Z" title="发表于 2025-01-01 17:19:27">2025-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/17/learn-cuda/" title="CUDA优化入门"><img src="/2024/04/17/learn-cuda/2024-04-16-15-52-38.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CUDA优化入门"/></a><div class="content"><a class="title" href="/2024/04/17/learn-cuda/" title="CUDA优化入门">CUDA优化入门</a><time datetime="2024-04-17T12:00:00.000Z" title="发表于 2024-04-17 20:00:00">2024-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/04/bipartite-match/" title="二分图的判断与匹配"><img src="/2024/04/04/bipartite-match/2024-04-05-00-11-55.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="二分图的判断与匹配"/></a><div class="content"><a class="title" href="/2024/04/04/bipartite-match/" title="二分图的判断与匹配">二分图的判断与匹配</a><time datetime="2024-04-04T13:43:47.000Z" title="发表于 2024-04-04 21:43:47">2024-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/19/summary/" title="长风破浪会有时"><img src="/2024/01/19/summary/wrapped2023.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="长风破浪会有时"/></a><div class="content"><a class="title" href="/2024/01/19/summary/" title="长风破浪会有时">长风破浪会有时</a><time datetime="2024-01-19T13:15:25.000Z" title="发表于 2024-01-19 21:15:25">2024-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/05/remote-vivado/" title="Vivado远程开发探索"><img src="/2023/06/05/remote-vivado/2023-06-15-16-22-13.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vivado远程开发探索"/></a><div class="content"><a class="title" href="/2023/06/05/remote-vivado/" title="Vivado远程开发探索">Vivado远程开发探索</a><time datetime="2023-06-05T09:52:47.000Z" title="发表于 2023-06-05 17:52:47">2023-06-05</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CUDA/"><span class="card-category-list-name">CUDA</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DSP%E5%BC%80%E5%8F%91/"><span class="card-category-list-name">DSP开发</span><span class="card-category-list-count">27</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DSP%E5%BC%80%E5%8F%91/C6455/"><span class="card-category-list-name">C6455</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DSP%E5%BC%80%E5%8F%91/M6678/"><span class="card-category-list-name">M6678</span><span class="card-category-list-count">8</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/NUEDC2021H/"><span class="card-category-list-name">NUEDC2021H</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Vivado/"><span class="card-category-list-name">Vivado</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/summary/"><span class="card-category-list-name">summary</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/6455/" style="font-size: 1.43em; color: #99a6b9">6455</a> <a href="/tags/6678/" style="font-size: 1.37em; color: #99a4b2">6678</a> <a href="/tags/ABI/" style="font-size: 1.1em; color: #999">ABI</a> <a href="/tags/ADC/" style="font-size: 1.1em; color: #999">ADC</a> <a href="/tags/ANN/" style="font-size: 1.1em; color: #999">ANN</a> <a href="/tags/AXI/" style="font-size: 1.17em; color: #999c9f">AXI</a> <a href="/tags/C/" style="font-size: 1.17em; color: #999c9f">C++</a> <a href="/tags/C-C/" style="font-size: 1.17em; color: #999c9f">C/C++</a> <a href="/tags/CCS/" style="font-size: 1.17em; color: #999c9f">CCS</a> <a href="/tags/CMake/" style="font-size: 1.1em; color: #999">CMake</a> <a href="/tags/CNN/" style="font-size: 1.1em; color: #999">CNN</a> <a href="/tags/CSL/" style="font-size: 1.1em; color: #999">CSL</a> <a href="/tags/CUDA/" style="font-size: 1.1em; color: #999">CUDA</a> <a href="/tags/CubeMX/" style="font-size: 1.1em; color: #999">CubeMX</a> <a href="/tags/DDR/" style="font-size: 1.1em; color: #999">DDR</a> <a href="/tags/DFT/" style="font-size: 1.1em; color: #999">DFT</a> <a href="/tags/DMA/" style="font-size: 1.17em; color: #999c9f">DMA</a> <a href="/tags/DSP/" style="font-size: 1.5em; color: #99a9bf">DSP</a> <a href="/tags/EDMA/" style="font-size: 1.17em; color: #999c9f">EDMA</a> <a href="/tags/EMCV/" style="font-size: 1.1em; color: #999">EMCV</a> <a href="/tags/EMIF/" style="font-size: 1.17em; color: #999c9f">EMIF</a> <a href="/tags/ESI/" style="font-size: 1.1em; color: #999">ESI</a> <a href="/tags/Eclipse/" style="font-size: 1.1em; color: #999">Eclipse</a> <a href="/tags/FFT/" style="font-size: 1.17em; color: #999c9f">FFT</a> <a href="/tags/FPGA/" style="font-size: 1.23em; color: #999ea6">FPGA</a> <a href="/tags/Flash/" style="font-size: 1.1em; color: #999">Flash</a> <a href="/tags/FreeRTOS/" style="font-size: 1.1em; color: #999">FreeRTOS</a> <a href="/tags/GPIO/" style="font-size: 1.1em; color: #999">GPIO</a> <a href="/tags/Git/" style="font-size: 1.1em; color: #999">Git</a> <a href="/tags/HOG/" style="font-size: 1.1em; color: #999">HOG</a> <a href="/tags/IIC/" style="font-size: 1.1em; color: #999">IIC</a> <a href="/tags/KCF/" style="font-size: 1.23em; color: #999ea6">KCF</a> <a href="/tags/KF/" style="font-size: 1.1em; color: #999">KF</a> <a href="/tags/Linux/" style="font-size: 1.1em; color: #999">Linux</a> <a href="/tags/M6678/" style="font-size: 1.3em; color: #99a1ac">M6678</a> <a href="/tags/MIO/" style="font-size: 1.1em; color: #999">MIO</a> <a href="/tags/MOSSE/" style="font-size: 1.1em; color: #999">MOSSE</a> <a href="/tags/Modelsim/" style="font-size: 1.1em; color: #999">Modelsim</a> <a href="/tags/NAND-Flash/" style="font-size: 1.17em; color: #999c9f">NAND Flash</a> <a href="/tags/OpenMP/" style="font-size: 1.1em; color: #999">OpenMP</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">84</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-02-25T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-01-01T14:35:31.040Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By 裘剑东</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>